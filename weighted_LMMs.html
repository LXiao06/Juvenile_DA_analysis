<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2025-12-09" />

<title>Weighted LMMs</title>

<script src="site_libs/header-attrs-2.30/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Juvenile DA Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="diagram/interactive-flowchart.html">Analytics Architecture</a>
</li>
<li>
  <a href="data_processing.html">Data Processing</a>
</li>
<li>
  <a href="individual_analysis.html">Individual Analysis</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Population Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="population_analysis.html">Overview</a>
    </li>
    <li>
      <a href="weighted_LMMs.html">Weighted LMMs</a>
    </li>
    <li>
      <a href="balanced_resampling.html">Balanced Resampling</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference.html">Reference</a>
</li>
<li>
  <a href="https://github.com/LXiao06/Juvenile_DA_analysis">GitHub</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Weighted LMMs</h1>
<h4 class="date">2025-12-09</h4>

</div>


<p><br />
</p>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>This tutorial demonstrates population-level analysis of
processed fiber photometry dopamine data from juvenile songbirds using
weighted Linear Mixed-effects Models (LMMs).</strong></p>
<p><br />
</p>
</div>
<div id="why-use-weighted-lmms" class="section level2">
<h2>Why Use Weighted LMMs?</h2>
<div id="the-unbalanced-data-problem" class="section level3">
<h3>The Unbalanced Data Problem</h3>
<p>In longitudinal studies of songbird vocal development, it is common
to have <strong>unbalanced data</strong> where:</p>
<ul>
<li>Some birds contribute more observations than others (e.g., due to
recording success, animal health, or experimental constraints)</li>
<li>The most-sampled individuals can become <strong>dominant
clusters</strong> that disproportionately influence population-level
estimates</li>
<li>Standard LMMs with random effects account for within-subject
correlation, but do not explicitly balance each animal’s contribution to
fixed effect estimates</li>
</ul>
<p><strong>Example data:</strong> If Bird A has 50 observations while
Birds B and C each have 10, Bird A contributes 71% of the data but
represents only 33% of the population. This can bias developmental trend
estimates toward patterns seen only in the well-sampled individual.</p>
</div>
<div id="available-weighting-methods" class="section level3">
<h3>Available Weighting Methods</h3>
<p>The VNS package provides three weighting approaches via the
<code>balance_method</code> parameter:</p>
<table>
<colgroup>
<col width="26%" />
<col width="30%" />
<col width="43%" />
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Formula</th>
<th>When to Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>"none"</code></td>
<td>No weighting</td>
<td>Balanced data or when all observations are equally informative</td>
</tr>
<tr class="even">
<td><code>"inverse"</code></td>
<td>weight = 1/n<sub>obs</sub></td>
<td>Heavily unbalanced sample sizes; ensures equal contribution per
animal</td>
</tr>
<tr class="odd">
<td><code>"sqrt_inverse"</code></td>
<td>weight = 1/√n<sub>obs</sub></td>
<td>Moderate imbalance; partial equalization while preserving some
sample size advantage</td>
</tr>
</tbody>
</table>
<p><br />
</p>
</div>
<div id="why-inverse-weighting" class="section level3">
<h3>Why Inverse Weighting?</h3>
<p>In this analysis, we use <strong>inverse weighting</strong>
(<code>balance_method = "inverse"</code>) because:</p>
<ol style="list-style-type: decimal">
<li><strong>Sample Size Imbalance</strong>: Our dataset has substantial
variation in observations per animal</li>
<li><strong>Equal Representation</strong>: Each animal should contribute
equally to population-level developmental trends, regardless of how many
data points were collected</li>
<li><strong>Avoid Dominant Clusters</strong>: Without weighting, animals
with more observations would disproportionately drive the fixed effect
estimates</li>
</ol>
<p><strong>How It Works:</strong></p>
<ul>
<li>Each observation is weighted by <code>1/n</code>, where
<code>n</code> is the number of observations for that animal</li>
<li>The sum of weights per animal equals 1, so all animals contribute
equally to the model</li>
<li>Well-sampled animals are downweighted; poorly-sampled animals are
upweighted</li>
</ul>
<p><br />
</p>
</div>
<div id="what-will-differ-from-unweighted-analysis"
class="section level3">
<h3>What Will Differ from Unweighted Analysis?</h3>
<p>Using weighted LMMs may affect:</p>
<table>
<colgroup>
<col width="30%" />
<col width="69%" />
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>Potential Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Fixed effect estimates</strong></td>
<td>May shift if over-sampled animals were biasing the trend</td>
</tr>
<tr class="even">
<td><strong>Standard errors</strong></td>
<td>Often more appropriate (neither over- nor under-confident)</td>
</tr>
<tr class="odd">
<td><strong>P-values</strong></td>
<td>May become more or less significant depending on data structure</td>
</tr>
<tr class="even">
<td><strong>Conclusions</strong></td>
<td>Generally more robust and generalizable to the population</td>
</tr>
<tr class="odd">
<td><strong>Figures</strong></td>
<td>Fitted lines may have different slopes; confidence intervals may
change</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> If unweighted and weighted analyses agree,
this provides stronger evidence for the findings. Divergence warrants
investigation of which animals drive the difference.</p>
</blockquote>
<p><br />
</p>
<blockquote>
<h3 id="install-required-packages">Install Required Packages</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_local</span>(<span class="fu">file.path</span>(<span class="fu">getwd</span>(),<span class="st">&quot;pkgs&quot;</span>, <span class="st">&quot;VNS_0.0.0.9001.tar.gz&quot;</span>),</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>                      <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</blockquote>
</div>
</div>
<div id="load-package" class="section level2">
<h2>Load Package</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;VNS&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">&quot;VNS&quot;</span>) </span></code></pre></div>
<p><br />
</p>
</div>
<div id="load-population-data" class="section level2">
<h2>Load Population Data</h2>
<p>Load the population data created from the data processing and
individual analysis pipeline.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./data/population_data.rda&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># Weighting method for all analyses</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>BALANCE_METHOD <span class="ot">&lt;-</span> <span class="st">&quot;inverse&quot;</span>  <span class="co"># Options: &quot;none&quot;, &quot;inverse&quot;, &quot;sqrt_inverse&quot;</span></span></code></pre></div>
<p><br />
</p>
</div>
<div id="temporal-shift-weighted-lmm" class="section level2">
<h2>Temporal Shift (Weighted LMM)</h2>
<div id="linear-mixed-effects-modeling-with-inverse-weighting"
class="section level3">
<h3>Linear Mixed Effects Modeling with Inverse Weighting</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>td_res <span class="ot">&lt;-</span> <span class="fu">analyze_td_metrics</span>(temporal_shift_res, <span class="at">balance_method =</span> BALANCE_METHOD)</span></code></pre></div>
<p><br />
</p>
</div>
<div id="figure-d-g-weighted-lmm-analysis" class="section level3">
<h3>Figure D-G: Weighted LMM Analysis</h3>
<p>Population-level analysis of temporal difference learning metrics
across vocal development using <strong>inverse-weighted LMMs</strong> to
balance individual contributions.</p>
<p>Weighted linear mixed-effects models showing developmental
trajectories of dopamine transient characteristics (n = 49 observations
from 5 birds, 63-91 dph). Median peak timing decreases with development
(top-left). Backward shift rate increases with development (top-right).
Temporal entropy decreases with development (lower-left). Gini
coefficient increases with development (lower-right).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">plot_td_panel</span>(temporal_shift_res, <span class="at">balance_method =</span> BALANCE_METHOD,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>              <span class="at">show_title =</span> <span class="cn">FALSE</span>, <span class="at">show_annotations =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Each colored dot represents the mean value for one animal at a given
age, with colors indicating individual animals.</p>
<p>Black lines show population-level fixed effects from
<strong>inverse-weighted LMMs</strong> with animal identity as random
intercept. Inverse weighting ensures each animal contributes equally
regardless of sample size.</p>
<p><br />
</p>
</div>
</div>
<div id="amplitude-shift-weighted-lmm" class="section level2">
<h2>Amplitude Shift (Weighted LMM)</h2>
<div id="linear-mixed-effects-modeling-with-inverse-weighting-1"
class="section level3">
<h3>Linear Mixed Effects Modeling with Inverse Weighting</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>td_res3 <span class="ot">&lt;-</span> <span class="fu">analyze_amplitude_metrics</span>(amplitude_shift_res, <span class="at">balance_method =</span> BALANCE_METHOD)</span></code></pre></div>
<p><br />
</p>
</div>
<div id="figure-n-p-weighted-lmm-analysis" class="section level3">
<h3>Figure N-P: Weighted LMM Analysis</h3>
<p>Population analysis of amplitude shift pattern across all animals
using <strong>inverse-weighted LMMs</strong>.</p>
<p>Early peak amplitude showed no significant developmental change
across the population (left). Late peak amplitude significantly
decreased with development (middle). Early/late amplitude ratio
significantly increased across development (right).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot_amplitude_panel</span>(amplitude_shift_res, <span class="at">balance_method =</span> BALANCE_METHOD,</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                     <span class="at">show_title =</span> <span class="cn">FALSE</span>, <span class="at">show_annotations =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Individual animals shown in different colors with fitted regression
lines. <strong>Inverse weighting</strong> balances contributions across
animals.</p>
<p><br />
</p>
</div>
<div id="within-window-analysis-weighted" class="section level3">
<h3>Within Window Analysis (Weighted)</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>td_res4 <span class="ot">&lt;-</span> <span class="fu">analyze_within_window_trends2</span>(amplitude_within_window_res,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                                         <span class="at">model =</span><span class="st">&quot;mixed_effects&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                                         <span class="at">balance_method =</span> BALANCE_METHOD,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                                         <span class="at">test_method =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                                         <span class="at">window_size =</span> <span class="dv">6</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                                         <span class="at">plot_results =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><br />
</p>
</div>
<div id="supplemental-figure-1-weighted-within-window-analysis"
class="section level3">
<h3>Supplemental Figure 1: Weighted Within-Window Analysis</h3>
<p>Population-level within-window paired analysis using
<strong>inverse-weighted mixed-effects models</strong> across 6-day
sliding windows.</p>
<p>Early amplitude showed no significant within-window change (left).
Late amplitude decreased significantly within windows (middle).
Amplitude ratio increased significantly within windows (right).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot_paired_metric_panel2</span>(td_res4, <span class="at">window_size =</span> <span class="dv">6</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Points: individual observations colored by animal</p>
<p>Gray lines: individual observations within each window (animal ×
window combinations).</p>
<p>Colored lines: mean trajectory for each animal across all
windows.</p>
<p>Black line with ribbon: population-level trend with 95% confidence
interval from <strong>inverse-weighted</strong> fixed effects.</p>
<p><br />
</p>
</div>
</div>
<div id="information-analysis-weighted-lmm" class="section level2">
<h2>Information Analysis (Weighted LMM)</h2>
<div id="linear-mixed-effects-modeling-with-inverse-weighting-2"
class="section level3">
<h3>Linear Mixed Effects Modeling with Inverse Weighting</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>td_res5 <span class="ot">&lt;-</span> <span class="fu">analyze_cH_metrics</span>(cH_res, <span class="at">balance_method =</span> BALANCE_METHOD)</span></code></pre></div>
<p><br />
</p>
</div>
<div id="figure-s-u-weighted-lmm-analysis" class="section level3">
<h3>Figure S-U: Weighted LMM Analysis</h3>
<p>Population analysis of directional conditional entropy across all
animals using <strong>inverse-weighted LMMs</strong>.</p>
<p>Forward conditional entropy significantly decreased with development
(left), indicating population-level improvement in predictive capability
from early to late temporal events. Backward conditional entropy showed
no significant developmental change (middle). Prediction asymmetry
significantly increased across development (right), with crossover from
backward to forward dominance predicted at 66.2 dph.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">plot_cH_panel</span>(cH_res, <span class="at">balance_method =</span> BALANCE_METHOD)</span></code></pre></div>
<p>Individual animals shown in different colors with fitted regression
lines. <strong>Inverse weighting</strong> ensures equal representation
per animal.</p>
<p><br />
</p>
</div>
<div id="within-window-analysis-weighted-1" class="section level3">
<h3>Within Window Analysis (Weighted)</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>td_res6 <span class="ot">&lt;-</span> <span class="fu">analyze_within_window_info_flow</span>(cH_within_window_res,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                                          <span class="at">model =</span><span class="st">&quot;mixed_effects&quot;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                                          <span class="at">balance_method =</span> BALANCE_METHOD,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                                          <span class="at">window_size =</span> <span class="dv">6</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                                          <span class="at">plot_results =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><br />
</p>
</div>
<div id="supplemental-figure-2-weighted-within-window-analysis"
class="section level3">
<h3>Supplemental Figure 2: Weighted Within-Window Analysis</h3>
<p>Population-level within-window paired analysis using
<strong>inverse-weighted mixed-effects models</strong> across 6-day
sliding windows.</p>
<p>Forward entropy decreased significantly within windows (left),
indicating improved forward predictability. Backward entropy showed no
significant within-window change (middle). Prediction asymmetry
increased significantly within windows (right), demonstrating a shift
toward forward prediction dominance.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot_paired_metric_panel2</span>(td_res6, <span class="at">window_size =</span> <span class="dv">6</span>,  <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Points: individual observations colored by animal.</p>
<p>Gray lines: individual observations within each window (animal ×
window combinations).</p>
<p>Colored lines: mean trajectory for each animal across all
windows.</p>
<p>Black line with ribbon: population-level trend with 95% confidence
interval from fixed effects.</p>
<p><br />
</p>
</div>
</div>
<div id="save-results" class="section level2">
<h2>Save Results</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Get all object names in the global environment</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>all_objects <span class="ot">&lt;-</span> <span class="fu">ls</span>()</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># Find objects that start with &quot;td&quot;</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>td_objects <span class="ot">&lt;-</span> all_objects[<span class="fu">grepl</span>(<span class="st">&quot;^td&quot;</span>, all_objects)]</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co"># Save objects starting with &quot;td&quot; to results.rda</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">save</span>(<span class="at">list =</span> td_objects, <span class="at">file =</span> <span class="st">&quot;./data/weighted_results.rda&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co"># To review the results in a new session load(&quot;./data/weighted_results.rda&quot;)</span></span></code></pre></div>
<p><br />
</p>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>This population analysis:</p>
<ol style="list-style-type: decimal">
<li><strong>Processed</strong> individual animal data and combined into
population datasets</li>
<li><strong>Analyzed</strong> temporal and amplitude dynamics across
multiple animals using LMMs</li>
<li><strong>Quantified</strong> information flow and predictive coding
development across multiple animals</li>
<li><strong>Generated</strong> comprehensive population-level
statistical results</li>
<li><strong>Saved</strong> analysis results for further
investigation<br />
<br />
</li>
</ol>
</div>
<div id="session-info" class="section level2">
<h2>Session Info</h2>
<pre><code>## R version 4.4.1 (2024-06-14)
## Platform: x86_64-pc-linux-gnu
## Running under: Ubuntu 24.04.3 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0
## 
## locale:
##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   
## 
## time zone: UTC
## tzcode source: system (glibc)
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## loaded via a namespace (and not attached):
##  [1] digest_0.6.39   R6_2.6.1        fastmap_1.2.0   xfun_0.54      
##  [5] cachem_1.1.0    knitr_1.50      htmltools_0.5.9 rmarkdown_2.30 
##  [9] lifecycle_1.0.4 cli_3.6.5       sass_0.4.10     jquerylib_0.1.4
## [13] compiler_4.4.1  tools_4.4.1     evaluate_1.0.5  bslib_0.9.0    
## [17] yaml_2.3.12     rlang_1.1.6     jsonlite_2.0.0</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
